<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Spelling Bee</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800;900&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --gold: #d4af37;
  --gold-dim: rgba(212,175,55,0.5);
  --gold-glow: rgba(212,175,55,0.15);
  --bg: #0c0a13;
  --card: rgba(30,26,46,0.97);
  --text: #f0ece2;
  --text-dim: rgba(255,255,255,0.55);
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body {
  height: 100%; overflow: hidden;
  background: var(--bg); color: var(--text);
  font-family: 'DM Sans', sans-serif;
  -webkit-user-select: none; user-select: none;
  -webkit-tap-highlight-color: transparent;
  -webkit-text-size-adjust: 100%;
}
body {
  display: flex; flex-direction: column;
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
  background: linear-gradient(170deg, #0c0a13 0%, #1a1528 45%, #110e1c 100%);
}

/* Header */
.header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 12px 16px 6px; flex-shrink: 0;
}
.header-left { display: flex; align-items: center; gap: 9px; }
.header-left span { font-size: 22px; }
.header-left h1 {
  font-family: 'Playfair Display', serif;
  font-size: 20px; font-weight: 700; letter-spacing: 0.02em;
}
.mode-btn {
  display: flex; align-items: center; gap: 6px;
  padding: 5px 13px; border-radius: 20px;
  border: 1.5px solid rgba(255,255,255,0.18);
  background: transparent; color: var(--text-dim);
  font-size: 12px; font-weight: 500; cursor: pointer;
  font-family: 'DM Sans', sans-serif; transition: all 0.25s;
}
.mode-btn.active {
  background: var(--gold-glow); border-color: var(--gold); color: var(--gold);
}
.mode-btn svg { width: 14px; height: 14px; }

/* Card */
.card-area {
  flex: 1; display: flex; flex-direction: column;
  padding: 6px 10px 0; overflow: hidden;
}
.card {
  flex: 1; display: flex; flex-direction: column;
  background: linear-gradient(150deg, rgba(38,32,56,0.97), rgba(22,18,36,0.99));
  border-radius: 22px;
  border: 1px solid rgba(212,175,55,0.1);
  padding: 16px 16px 14px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.04);
  overflow-y: auto; overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  transition: transform 0.08s ease;
}
.card::-webkit-scrollbar { display: none; }
.card-top {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 12px; flex-shrink: 0;
}
.counter { font-size: 11px; color: rgba(255,255,255,0.3); font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; }
.side-label { font-size: 9px; font-weight: 700; letter-spacing: 0.16em; color: var(--gold-dim); text-transform: uppercase; }
.card-top-right { display: flex; align-items: center; gap: 10px; }
.mark-btn {
  background: none; border: none; cursor: pointer; padding: 2px;
  color: rgba(255,255,255,0.25); transition: all 0.2s;
}
.mark-btn.active { color: var(--gold); }
.mark-btn svg { width: 22px; height: 22px; }

/* Sections */
.sect { display: flex; flex-direction: column; gap: 3px; margin-bottom: 11px; }
.tag {
  font-size: 9px; font-weight: 700; letter-spacing: 0.16em;
  color: var(--gold); text-transform: uppercase; opacity: 0.75; margin-bottom: 1px;
}
.pron-main {
  font-family: 'Playfair Display', serif;
  font-size: 21px; font-weight: 700; letter-spacing: 0.05em;
}
.ipa { font-size: 13px; color: rgba(255,255,255,0.38); font-family: monospace; }
.listen-btn {
  display: inline-flex; align-items: center; gap: 7px;
  padding: 5px 14px; border-radius: 20px;
  border: 1px solid rgba(212,175,55,0.3); background: rgba(212,175,55,0.08);
  color: var(--gold); cursor: pointer; font-family: 'DM Sans', sans-serif;
  font-size: 12.5px; font-weight: 500; margin-top: 5px; align-self: flex-start;
  transition: all 0.2s;
}
.listen-btn:active { background: rgba(212,175,55,0.2); }
.listen-btn svg { width: 15px; height: 15px; }
.pos-chip {
  display: inline-block; padding: 3px 12px; border-radius: 14px;
  background: rgba(212,175,55,0.1); border: 1px solid rgba(212,175,55,0.22);
  color: var(--gold); font-size: 13px; font-weight: 600; font-style: italic;
}
.def-text { font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.85); }
.origin-text { font-size: 13px; line-height: 1.55; color: var(--text-dim); font-style: italic; }
.ex-text {
  font-size: 13px; line-height: 1.6; color: rgba(255,255,255,0.65);
  border-left: 3px solid rgba(212,175,55,0.35); padding-left: 12px; font-style: italic;
}

/* Tap hint */
.tap-hint {
  text-align: center; padding: 12px 0 4px;
  font-size: 12px; color: rgba(255,255,255,0.2);
  letter-spacing: 0.04em; flex-shrink: 0;
}

/* Back */
.back-content { display: flex; flex-direction: column; align-items: center; gap: 20px; padding-top: 6px; flex: 1; }
.spelling-box {
  text-align: center; width: 100%; padding: 22px 12px 18px;
  background: linear-gradient(135deg, rgba(212,175,55,0.07), rgba(212,175,55,0.02));
  border-radius: 16px; border: 1px solid rgba(212,175,55,0.15);
}
.spelling-label {
  font-size: 10px; font-weight: 700; letter-spacing: 0.22em;
  color: rgba(212,175,55,0.6); text-transform: uppercase; margin-bottom: 10px;
}
.spelling-word {
  font-family: Verdana, Geneva, sans-serif; font-size: 36px; font-weight: 400;
  letter-spacing: 0.04em; line-height: 1.15;
  text-shadow: 0 2px 16px rgba(212,175,55,0.2); margin-bottom: 14px;
}
.letters-row { display: flex; justify-content: center; gap: 3px; flex-wrap: wrap; }
.letter-tile {
  display: inline-flex; align-items: center; justify-content: center;
  width: 27px; height: 34px; border-radius: 6px;
  background: rgba(212,175,55,0.08); border: 1px solid rgba(212,175,55,0.2);
  color: var(--gold); font-family: 'Playfair Display', serif;
  font-size: 17px; font-weight: 700;
  animation: letterPop 0.35s cubic-bezier(0.34,1.56,0.64,1) both;
}
.image-box {
  width: 100%; border-radius: 14px; overflow: hidden;
  border: 1px solid rgba(255,255,255,0.08); position: relative;
  animation: popIn 0.4s cubic-bezier(0.34,1.56,0.64,1) both;
  animation-delay: 0.15s;
}
.word-img { width: 100%; height: 190px; object-fit: cover; display: block; }
.img-caption {
  position: absolute; bottom: 0; left: 0; right: 0;
  padding: 20px 14px 8px;
  background: linear-gradient(transparent, rgba(0,0,0,0.7));
  font-size: 12px; font-weight: 600; color: rgba(255,255,255,0.7);
  letter-spacing: 0.06em; text-transform: capitalize;
}
.loading-box { display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 20px 0; }
.spinner {
  width: 22px; height: 22px;
  border: 2.5px solid rgba(212,175,55,0.2);
  border-top-color: var(--gold); border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
.loading-text { color: rgba(255,255,255,0.35); font-size: 12px; }

/* Bottom bar */
.bottom-bar {
  flex-shrink: 0;
  padding: 10px 16px 12px;
  display: flex; flex-direction: column; gap: 6px;
}
.nav-row {
  display: flex; align-items: center; justify-content: center; gap: 12px;
}
.nav-arrow {
  display: flex; align-items: center; justify-content: center;
  width: 36px; height: 36px; border-radius: 50%;
  border: 1.5px solid rgba(255,255,255,0.15);
  background: rgba(255,255,255,0.04);
  color: rgba(255,255,255,0.5); cursor: pointer;
  transition: all 0.2s; flex-shrink: 0;
}
.nav-arrow:active { background: rgba(212,175,55,0.15); border-color: var(--gold); color: var(--gold); transform: scale(0.92); }
.nav-arrow svg { width: 18px; height: 18px; }
.slider-area {
  flex: 1; height: 32px; position: relative;
  display: flex; align-items: center;
  touch-action: none; cursor: pointer;
}
.slider-track-bg {
  width: 100%; height: 3px; border-radius: 2px;
  background: rgba(255,255,255,0.08); position: relative; overflow: hidden;
}
.slider-fill {
  height: 100%; border-radius: 2px;
  background: linear-gradient(90deg, var(--gold), rgba(212,175,55,0.5));
  transition: width 0.15s ease;
}
.slider-dots {
  position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  display: flex; align-items: center; justify-content: space-between;
  pointer-events: none; padding: 0 2px;
}
.slider-tick {
  width: 2px; height: 8px; border-radius: 1px;
  background: rgba(255,255,255,0.06); flex-shrink: 0;
}
.slider-tick.major { height: 12px; background: rgba(255,255,255,0.12); }
.slider-tick.active { background: var(--gold); height: 14px; width: 3px; border-radius: 1.5px; box-shadow: 0 0 6px rgba(212,175,55,0.4); }
.slider-thumb {
  position: absolute; top: 50%; transform: translate(-50%, -50%);
  width: 20px; height: 20px; border-radius: 50%;
  background: var(--gold);
  border: 2.5px solid #1a1528;
  box-shadow: 0 0 10px rgba(212,175,55,0.5), 0 2px 6px rgba(0,0,0,0.4);
  cursor: grab; transition: left 0.12s ease;
  z-index: 2;
}
.slider-thumb:active { cursor: grabbing; transform: translate(-50%, -50%) scale(1.15); }
.slider-thumb.dragging { transition: none; transform: translate(-50%, -50%) scale(1.15); }
.slider-counter {
  text-align: center; font-size: 11px; font-weight: 600;
  color: rgba(255,255,255,0.25); letter-spacing: 0.08em;
}

/* Animations */
@keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
@keyframes popIn { 0% { transform: scale(0.92); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
@keyframes letterPop { 0% { transform: scale(0) rotate(-8deg); opacity: 0; } 60% { transform: scale(1.1) rotate(2deg); opacity: 1; } 100% { transform: scale(1) rotate(0); opacity: 1; } }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
@keyframes slideOutL { from { transform: translateX(0); opacity: 1; } to { transform: translateX(-105%); opacity: 0; } }
@keyframes slideOutR { from { transform: translateX(0); opacity: 1; } to { transform: translateX(105%); opacity: 0; } }
.slide-out-l { animation: slideOutL 0.22s ease forwards; }
.slide-out-r { animation: slideOutR 0.22s ease forwards; }
.fade-in { animation: fadeUp 0.3s ease both; }
</style>
</head>
<body>

<div class="header">
  <div class="header-left">
    <span>üêù</span>
    <h1><a href="index.html" style="color:inherit;text-decoration:none;">Spelling Bee</a></h1>
  </div>
  <button class="mode-btn" id="modeBtn" onclick="toggleMarkedOnly()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
    <span id="modeBtnText">All (6)</span>
  </button>
</div>

<div class="card-area" id="cardArea">
  <div class="card" id="card"></div>
</div>

<div class="bottom-bar">
  <div class="nav-row">
    <button class="nav-arrow" id="prevBtn" onclick="navigateTo('right')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
    </button>
    <div class="slider-area" id="sliderArea">
      <div class="slider-track-bg">
        <div class="slider-fill" id="sliderFill"></div>
      </div>
      <div class="slider-dots" id="sliderDots"></div>
      <div class="slider-thumb" id="sliderThumb"></div>
    </div>
    <button class="nav-arrow" id="nextBtn" onclick="navigateTo('left')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"/></svg>
    </button>
  </div>
  <div class="slider-counter" id="sliderCounter">1 / 208</div>
</div>

<script>
const WORDS = [
  { word:'macaw', pronunciation:'muh-KAW', ipa:'/m…ôÀàk…îÀê/', pos:'noun', def:'A large, long-tailed, brightly colored parrot native to Central and South America.', lang:'Portuguese, from macau, from Tupi macavuana, the name for the bird in the indigenous language of Brazil.', example:'The scarlet macaw spread its brilliant red, yellow, and blue wings as it launched from the treetop into the jungle canopy.', isNoun:true },
  { word:'maddening', pronunciation:'MAD-un-ing', ipa:'/Ààm√¶d…ôn…™≈ã/', pos:'adjective', def:'Extremely annoying or frustrating; driving one to distraction.', lang:'English, from madden (\'to make mad\'), from mad (from Old English gem√¶d, \'insane\'), + -en + -ing.', example:'The maddening buzz of a single mosquito in the dark bedroom kept her awake for what felt like the entire night.', isNoun:false },
  { word:'madrigal', pronunciation:'MAD-rih-gul', ipa:'/Ààm√¶dr…™…°…ôl/', pos:'noun', def:'A part-song for several voices, especially one from the Renaissance period, typically without instrumental accompaniment.', lang:'Italian, from madrigale, possibly from Latin matricalis (\'simple, primitive\'), from matrix (\'womb\'), or from mandra (\'flock\').', example:'The choir performed a beautiful Renaissance madrigal, their unaccompanied voices weaving intricate harmonies through the stone chapel.', isNoun:true },
  { word:'magician', pronunciation:'muh-JIH-shun', ipa:'/m…ôÀàd í…™ É…ôn/', pos:'noun', def:'A person with magical powers; an entertainer who performs tricks of illusion and sleight of hand.', lang:'Old French, from magicien, from Latin magica (\'magic\'), from Greek magike (tekhne) (\'sorcerer\'s art\'), from magos (\'sorcerer\').', example:'The magician pulled a live rabbit from an empty hat, delighting the children who crowded around the stage.', isNoun:true },
  { word:'mahogany', pronunciation:'muh-HOG-uh-nee', ipa:'/m…ôÀàh…í…°…ôni/', pos:'noun', def:'A hard reddish-brown wood from a tropical tree, widely used for fine furniture and paneling.', lang:'English, of unknown origin, possibly from a Mayan or other Central American indigenous language; first recorded in the 1670s.', example:'The antique mahogany desk had a rich, deep reddish glow that only improved with age and careful polishing.', isNoun:true },
  { word:'maidenhair', pronunciation:'MAY-dun-hair', ipa:'/Ààme…™d…ônÀåh…õ…ôr/', pos:'noun', def:'A delicate fern with slender black stalks and small, fan-shaped fronds, often found near waterfalls and in moist, shaded areas.', lang:'English, from maiden + hair, because the fine, dark stems were thought to resemble a young woman\'s hair.', example:'Clumps of delicate maidenhair fern clung to the damp rocks behind the waterfall, their lacy fronds trembling in the mist.', isNoun:true },
  { word:'maize', pronunciation:'MAYZ', ipa:'/me…™z/', pos:'noun', def:'A Central American cereal plant that yields large grains set in rows on a cob; corn.', lang:'Spanish, from ma√≠z, from Taino mahiz, the name used by the indigenous Caribbean people for the grain.', example:'The farmer harvested acres of golden maize in the autumn, the tall stalks rustling in the cool October breeze.', isNoun:true },
  { word:'mambo', pronunciation:'MAM-boh', ipa:'/Ààm√¶mbo ä/', pos:'noun', def:'A Latin American dance similar to the rumba, characterized by a strong rhythmic beat and hip movements.', lang:'Cuban Spanish, from mambo, possibly from Haitian Creole, originally referring to a voodoo priestess, later applied to the dance and music.', example:'The couple danced the mambo with such fiery passion that the entire dance floor stopped to watch their electrifying moves.', isNoun:true },
  { word:'manacle', pronunciation:'MAN-uh-kul', ipa:'/Ààm√¶n…ôk…ôl/', pos:'noun', def:'A metal band, chain, or shackle for the hands or feet; a restraint or bond.', lang:'Old French, from manicle (\'handcuff\'), from Latin manicula (\'little hand\'), diminutive of manus (\'hand\').', example:'The escape artist freed himself from the heavy manacles in under sixty seconds, leaving the stunned audience in disbelief.', isNoun:true },
  { word:'manifests', pronunciation:'MAN-ih-fests', ipa:'/Ààm√¶n…™Àåf…õsts/', pos:'verb', def:'Displays or shows a quality or feeling by one\'s acts; becomes apparent or evident; lists of cargo or passengers.', lang:'Latin, from manifestus (\'caught in the act, evident\'), from manus (\'hand\') + festus (\'struck\'), literally \'struck by hand\'.', example:'Her dedication to the craft manifests in every brushstroke, each painting revealing years of patient practice and study.', isNoun:false },
  { word:'mantra', pronunciation:'MAN-truh', ipa:'/Ààm√¶ntr…ô/', pos:'noun', def:'A word or phrase repeated in meditation; a statement or slogan repeated frequently.', lang:'Sanskrit, from mantra (\'instrument of thought, sacred text\'), from man (\'to think\').', example:'Her daily mantra of \'progress, not perfection\' helped her stay motivated through the most challenging days of training.', isNoun:true },
  { word:'manure', pronunciation:'muh-NOOR', ipa:'/m…ôÀànj ä…ôr/', pos:'noun', def:'Animal dung used for fertilizing land; any compost or fertilizer applied to soil.', lang:'Old French, from manouvrer (\'to cultivate land\'), from Latin manu operare (\'to work with the hand\'), from manus (\'hand\') + operare (\'to work\').', example:'The organic farmer spread composted manure across the fields each spring, enriching the soil for the season\'s crops.', isNoun:true },
  { word:'manuscript', pronunciation:'MAN-yoo-skript', ipa:'/Ààm√¶nj äÀåskr…™pt/', pos:'noun', def:'A book, document, or piece of music written by hand; an author\'s text submitted for publication.', lang:'Latin, from manu scriptus (\'written by hand\'), from manus (\'hand\') + scribere (\'to write\').', example:'The medieval manuscript, illuminated with gold leaf and vivid pigments, had survived eight centuries in the monastery library.', isNoun:true },
  { word:'marathon', pronunciation:'MAIR-uh-thon', ipa:'/Ààm√¶r…ôÀåŒ∏…ín/', pos:'noun', def:'A long-distance running race of 26.2 miles; any long-lasting or difficult task or activity.', lang:'Greek, from Marathon, the site of a battle in 490 BC, after which a messenger allegedly ran to Athens to announce victory.', example:'Crossing the marathon finish line after months of grueling training was the proudest achievement of her entire life.', isNoun:true },
  { word:'maritime', pronunciation:'MAIR-ih-tym', ipa:'/Ààm√¶r…™Àåta…™m/', pos:'adjective', def:'Connected with the sea, especially in relation to shipping, navigation, or naval matters.', lang:'Latin, from maritimus (\'of the sea\'), from mare (\'sea\').', example:'The maritime museum housed a collection of historic ships, navigation instruments, and artifacts recovered from famous shipwrecks.', isNoun:false },
  { word:'marooned', pronunciation:'muh-ROOND', ipa:'/m…ôÀàruÀênd/', pos:'adjective', def:'Stranded in an isolated and uninhabited place; left behind and unable to leave.', lang:'French, from marron (\'feral, runaway\'), from Spanish cimarr√≥n (\'wild, untamed\'), originally applied to escaped slaves living in remote areas.', example:'The sailors were marooned on the tiny island for three weeks before a passing fishing boat spotted their signal fire.', isNoun:false },
  { word:'martial', pronunciation:'MAR-shul', ipa:'/Ààm…ëÀêr É…ôl/', pos:'adjective', def:'Of or relating to war or the armed forces; warlike and brave.', lang:'Latin, from martialis (\'of Mars\'), from Mars (the Roman god of war).', example:'She earned a black belt in martial arts after ten years of dedicated practice in karate and judo.', isNoun:false },
  { word:'Martian', pronunciation:'MAR-shun', ipa:'/Ààm…ëÀêr É…ôn/', pos:'noun', def:'A supposed inhabitant of the planet Mars; of or relating to the planet Mars.', lang:'Latin, from Martianus (\'of Mars\'), from Mars (the Roman god of war and the fourth planet), + -ian.', example:'Science fiction writers have imagined Martian civilizations for over a century, from H.G. Wells to modern filmmakers.', isNoun:true },
  { word:'maternity', pronunciation:'muh-TUR-nih-tee', ipa:'/m…ôÀàt…úÀêrn…™ti/', pos:'noun', def:'The state of being a mother; the period during pregnancy and shortly after childbirth; relating to pregnant women.', lang:'Latin, from maternitas (\'motherhood\'), from maternus (\'maternal\'), from mater (\'mother\').', example:'The company offered twelve weeks of paid maternity leave, allowing new mothers time to bond with their babies.', isNoun:true },
  { word:'matrimony', pronunciation:'MAT-rih-MOH-nee', ipa:'/Ààm√¶tr…™Àåmo äni/', pos:'noun', def:'The state or ceremony of being married; wedlock.', lang:'Latin, from matrimonium (\'wedlock\'), from mater (\'mother\') + -monium (suffix denoting action or state).', example:'The couple entered into holy matrimony on a sun-drenched afternoon, exchanging vows beneath an arch of white roses.', isNoun:true },
  { word:'mauve', pronunciation:'MOHV', ipa:'/mo äv/', pos:'noun', def:'A pale purple color; a synthetic dye of this color, the first aniline dye, discovered in 1856.', lang:'French, from mauve (\'mallow plant\'), from Latin malva (\'mallow\'), because the color resembles the flower of the mallow plant.', example:'She painted the nursery walls a soft mauve that gave the room a gentle, dreamy quality in the afternoon light.', isNoun:true },
  { word:'maximum', pronunciation:'MAK-sih-mum', ipa:'/Ààm√¶ks…™m…ôm/', pos:'noun', def:'The greatest amount, extent, or intensity possible or allowed; the highest point reached.', lang:'Latin, from maximum (\'greatest thing\'), neuter of maximus (\'greatest\'), superlative of magnus (\'great\').', example:'The elevator had a maximum capacity of twelve people, and the building manager enforced the limit strictly.', isNoun:true },
  { word:'mayhem', pronunciation:'MAY-hem', ipa:'/Ààme…™h…õm/', pos:'noun', def:'Violent or damaging disorder; chaos; in law, the crime of maliciously injuring or maiming someone.', lang:'Old French, from mahaigne (\'injury, maiming\'), of Germanic origin; originally a legal term for deliberate mutilation.', example:'The surprise snowstorm caused mayhem on the highways, with hundreds of cars stranded and traffic at a complete standstill.', isNoun:true },
  { word:'meaningful', pronunciation:'MEE-ning-ful', ipa:'/ÀàmiÀên…™≈ãf äl/', pos:'adjective', def:'Having meaning; significant and purposeful; communicating something that is not directly expressed.', lang:'English, from meaning (from Old English m√¶nan, \'to intend, signify\') + -ful.', example:'The meaningful glance between the two old friends communicated more in a single second than words ever could.', isNoun:false },
  { word:'medallion', pronunciation:'muh-DAL-yun', ipa:'/m…ôÀàd√¶lj…ôn/', pos:'noun', def:'A large medal or coin-shaped decoration; a large circular piece of food; an oval or circular design used in decoration.', lang:'French, from m√©daillon (\'a large medal\'), from Italian medaglione, augmentative of medaglia (\'medal\'), from Latin metallum (\'metal\').', example:'The chef served tender beef medallions on a bed of creamy mashed potatoes with a rich red wine reduction sauce.', isNoun:true },
  { word:'melody', pronunciation:'MEL-uh-dee', ipa:'/Ààm…õl…ôdi/', pos:'noun', def:'A sequence of musical notes that form a recognizable tune; the principal part in harmonized music.', lang:'Greek, from meloidia (\'a singing, a chanting\'), from melos (\'song, tune\') + aeidein (\'to sing\').', example:'The haunting melody of the violin solo lingered in the concert hall long after the last note had faded away.', isNoun:true },
  { word:'melted', pronunciation:'MEL-tid', ipa:'/Ààm…õlt…™d/', pos:'verb', def:'Changed from a solid to a liquid state by heating; became less rigid or tense; dissolved or disappeared gradually.', lang:'Old English, from meltan (\'to become liquid, dissolve\'), of Germanic origin.', example:'The chocolate melted slowly in the double boiler, transforming into a glossy, smooth river of dark sweetness.', isNoun:false },
  { word:'membership', pronunciation:'MEM-bur-ship', ipa:'/Ààm…õmb…ôrÀå É…™p/', pos:'noun', def:'The state of belonging to a group or organization; the members of a group collectively.', lang:'English, from member (from Latin membrum, \'a limb, part of the body\') + -ship (\'state or condition of\').', example:'Her membership in the book club connected her with fellow readers who shared her passion for historical fiction.', isNoun:true },
  { word:'memes', pronunciation:'MEEMZ', ipa:'/miÀêmz/', pos:'noun', def:'Images, videos, or text spread rapidly by internet users, often humorous and culturally relevant; units of cultural information.', lang:'English, coined by Richard Dawkins in 1976 from Greek mimeme (\'something imitated\'), shortened to rhyme with gene.', example:'The hilarious memes about the award show blunder spread across social media within minutes of the live broadcast.', isNoun:true },
  { word:'memorandum', pronunciation:'MEM-uh-RAN-dum', ipa:'/Àåm…õm…ôÀàr√¶nd…ôm/', pos:'noun', def:'A written message in business or diplomacy; a note recording something for future use.', lang:'Latin, from memorandum (\'something to be remembered\'), neuter gerundive of memorare (\'to bring to mind\'), from memor (\'mindful\').', example:'The office memorandum informed all employees that the holiday party would be held in the main conference room on Friday.', isNoun:true },
  { word:'mentor', pronunciation:'MEN-tor', ipa:'/Ààm…õnt…îÀêr/', pos:'noun', def:'An experienced and trusted adviser; a guide who helps someone develop skills and knowledge.', lang:'Greek, from Mentor, the name of a character in Homer\'s Odyssey who advised the young Telemachus while his father Odysseus was away.', example:'The seasoned professor served as a mentor to dozens of young scientists, guiding their research and encouraging their careers.', isNoun:true },
  { word:'menu', pronunciation:'MEN-yoo', ipa:'/Ààm…õnjuÀê/', pos:'noun', def:'A list of dishes available in a restaurant; a list of options on a computer screen.', lang:'French, from menu (\'small, detailed\'), from Latin minutus (\'small, minute\'), because it was a detailed list.', example:'The restaurant\'s menu featured dishes from six different countries, offering everything from sushi to Moroccan tagine.', isNoun:true },
  { word:'merchandise', pronunciation:'MUR-chun-dyze', ipa:'/Ààm…úÀêrt É…ônÀåda…™z/', pos:'noun', def:'Goods to be bought and sold; commercial products; branded products connected with a movie, band, or sports team.', lang:'Old French, from marchandise (\'trade, goods\'), from marchand (\'merchant\'), from Latin mercari (\'to trade\'), from merx (\'goods\').', example:'The band\'s merchandise table was mobbed after the concert, with fans eager to buy t-shirts, posters, and vinyl records.', isNoun:true },
  { word:'mercury', pronunciation:'MUR-kyoo-ree', ipa:'/Ààm…úÀêrkj äri/', pos:'noun', def:'A heavy silvery-white liquid metal used in thermometers and barometers; the planet closest to the sun.', lang:'Latin, from Mercurius, the Roman messenger god known for his speed, applied to the metal because of its fluid, quicksilver nature.', example:'The old thermometer contained a thin column of mercury that rose and fell with the temperature of the room.', isNoun:true },
  { word:'Merlin', pronunciation:'MUR-lin', ipa:'/Ààm…úÀêrl…™n/', pos:'noun', def:'A legendary wizard and adviser to King Arthur in Arthurian legend; a small dark falcon that hunts small birds.', lang:'Welsh, from Myrddin, a legendary prophet and wizard in Welsh tradition; the bird name comes from Old French esmerillon (\'a small hawk\').', example:'In the legend, Merlin used his great magical powers to guide the young Arthur toward his destiny as king of Britain.', isNoun:true },
  { word:'meteor', pronunciation:'MEE-tee-ur', ipa:'/ÀàmiÀêti…ôr/', pos:'noun', def:'A small body of matter from outer space that enters the earth\'s atmosphere, appearing as a streak of light; a shooting star.', lang:'Greek, from mete≈çron (\'an atmospheric phenomenon\'), from mete≈çros (\'raised up, lofty\'), from meta (\'beyond\') + aeirein (\'to lift\').', example:'A bright meteor streaked across the dark sky, leaving a glowing trail that faded within seconds as the crowd gasped in wonder.', isNoun:true },
  { word:'metrical', pronunciation:'MET-rih-kul', ipa:'/Ààm…õtr…™k…ôl/', pos:'adjective', def:'Of, relating to, or composed in poetic meter; having a measured rhythm.', lang:'Latin, from metricus (\'of or pertaining to meter\'), from Greek metrikos, from metron (\'measure\'), + -al.', example:'The poet\'s metrical precision gave each line a rhythmic pulse that mirrored the steady beating of a heart.', isNoun:false },
  { word:'Michigander', pronunciation:'MISH-ih-GAN-dur', ipa:'/Àåm…™ É…™Àà…°√¶nd…ôr/', pos:'noun', def:'A native or resident of the state of Michigan.', lang:'English, from Michigan (from Ojibwe mishigamaa, \'large water\' or \'large lake\') + -ander (by analogy with gander).', example:'As a proud Michigander, she never missed a chance to boast about the Great Lakes, cherry orchards, and autumn colors of her home state.', isNoun:true },
  { word:'migratory', pronunciation:'MY-gruh-TOR-ee', ipa:'/Ààma…™…°r…ôÀåt…îÀêri/', pos:'adjective', def:'Tending to migrate or having the habit of migrating; relating to or characterized by migration.', lang:'Latin, from migratorius, from migrare (\'to move from one place to another\'), + -ory.', example:'The migratory birds flew thousands of miles each autumn, navigating by the stars from Canada to Central America.', isNoun:false },
  { word:'millionaire', pronunciation:'MIL-yuh-NAIR', ipa:'/Àåm…™lj…ôÀàn…õ…ôr/', pos:'noun', def:'A person whose assets or income amount to a million or more units of currency.', lang:'French, from millionnaire, from million (from Italian milione, augmentative of mille, \'thousand\', from Latin mille) + -aire.', example:'The self-made millionaire started with nothing but a good idea, turning a small garage workshop into a global technology company.', isNoun:true },
  { word:'mince', pronunciation:'MINSE', ipa:'/m…™ns/', pos:'verb', def:'To cut or grind food into very small pieces; to walk in an affectedly dainty manner; to soften or moderate one\'s words.', lang:'Old French, from mincier (\'to cut small\'), from Latin minutiare (\'to make small\'), from minutia (\'smallness\').', example:'She did not mince words when telling the team exactly what they needed to improve before the next competition.', isNoun:false },
  { word:'ministry', pronunciation:'MIN-ih-stree', ipa:'/Ààm…™n…™stri/', pos:'noun', def:'A government department headed by a minister; the work or vocation of a minister of religion; a period of government.', lang:'Latin, from ministerium (\'service, attendance\'), from minister (\'servant, attendant\'), from minus (\'less\').', example:'The Ministry of Education announced sweeping reforms to modernize the school curriculum across the entire country.', isNoun:true },
  { word:'minutia', pronunciation:'mih-NOO-shee-uh', ipa:'/m…™ÀànjuÀê Éi…ô/', pos:'noun', def:'A small or trivial detail; the precise, small details of something.', lang:'Latin, from minutia (\'smallness, trifle\'), from minutus (\'small, minute\'), from minuere (\'to lessen\').', example:'The contract lawyer examined every minutia of the agreement, ensuring that no small detail could cause problems later.', isNoun:true },
  { word:'miraculous', pronunciation:'mih-RAK-yoo-lus', ipa:'/m…™Ààr√¶kj äl…ôs/', pos:'adjective', def:'Occurring through divine or supernatural intervention; remarkable and extraordinary; highly improbable and welcome.', lang:'Latin, from miraculosus, from miraculum (\'an object of wonder\'), from mirari (\'to wonder at\'), from mirus (\'wonderful\').', example:'The patient made a miraculous recovery, walking out of the hospital just two weeks after the doctors had given up hope.', isNoun:false },
  { word:'mischief', pronunciation:'MIS-chif', ipa:'/Ààm…™st É…™f/', pos:'noun', def:'Playful misbehavior or troublemaking; harm or trouble caused by someone or something.', lang:'Old French, from meschief (\'misfortune\'), from mes- (\'badly\') + chief (\'head, end\'), from Latin caput; originally meaning \'bad outcome\'.', example:'The puppy was full of mischief, chewing shoes, unrolling toilet paper, and stealing socks from the laundry basket.', isNoun:true },
  { word:'missile', pronunciation:'MIS-ul', ipa:'/Ààm…™s…ôl/', pos:'noun', def:'A weapon that is self-propelled or directed by remote control, carrying conventional or nuclear explosives; any object thrown as a weapon.', lang:'Latin, from missile (\'something to be thrown\'), neuter of missilis (\'that may be thrown\'), from mittere (\'to send, throw\').', example:'The defense system detected the incoming missile and launched a countermeasure to intercept it before it reached the coastline.', isNoun:true },
  { word:'missive', pronunciation:'MIS-iv', ipa:'/Ààm…™s…™v/', pos:'noun', def:'A letter, especially a long or official one; a written message.', lang:'Latin, from missivus (\'sent\'), from mittere (\'to send\'); originally used in the phrase littera missiva (\'letter sent\'.', example:'The ambassador delivered a formal missive from the president, requesting an immediate meeting to discuss the trade agreement.', isNoun:true },
  { word:'mockery', pronunciation:'MOK-ur-ee', ipa:'/Ààm…ík…ôri/', pos:'noun', def:'Teasing and contemptuous language or behavior; an absurd misrepresentation or imitation of something.', lang:'Old French, from moquerie (\'derision\'), from moquer (\'to mock, deride\'), of uncertain origin, + -ery.', example:'The comedian\'s gentle mockery of everyday life had the audience laughing at the absurdities they all recognized.', isNoun:true },
  { word:'modality', pronunciation:'moh-DAL-ih-tee', ipa:'/mo äÀàd√¶l…™ti/', pos:'noun', def:'A particular mode or method of doing something; a particular form of sensory perception; a type of medical treatment.', lang:'Latin, from modalitas, from modalis (\'relating to mode\'), from modus (\'measure, manner\'), + -ity.', example:'The therapist combined multiple treatment modalities, including talk therapy, art therapy, and mindfulness meditation.', isNoun:true },
  { word:'modem', pronunciation:'MOH-dem', ipa:'/Ààmo äd…õm/', pos:'noun', def:'A device that converts digital data into a format suitable for transmission over telephone lines or other communication channels.', lang:'English, a blend of modulator + demodulator, describing the device\'s function of converting signals back and forth.', example:'In the early days of the internet, the modem\'s distinctive screeching dial-up tone was the sound of connecting to the online world.', isNoun:true },
  { word:'modify', pronunciation:'MOD-ih-fy', ipa:'/Ààm…íd…™Àåfa…™/', pos:'verb', def:'To make partial or minor changes to something; to alter without transforming completely.', lang:'Latin, from modificare (\'to limit, control\'), from modus (\'measure, manner\') + facere (\'to make\').', example:'The engineer had to modify the original design to accommodate the client\'s request for a larger rooftop terrace.', isNoun:false },
  { word:'modular', pronunciation:'MOJ-oo-lur', ipa:'/Ààm…íd í äl…ôr/', pos:'adjective', def:'Composed of separate units or sections that can be combined or interchanged; designed with standardized units for flexibility.', lang:'Latin, from modulus (\'a small measure\'), diminutive of modus (\'measure\'), + -ar.', example:'The modular furniture could be rearranged into dozens of configurations, adapting perfectly to any room layout.', isNoun:false },
  { word:'molasses', pronunciation:'muh-LAS-iz', ipa:'/m…ôÀàl√¶s…™z/', pos:'noun', def:'A thick, dark brown syrup obtained from raw sugar during the refining process; used in cooking and baking.', lang:'Portuguese, from mela√ßo (\'honey-like\'), from Latin mellaceum (\'resembling honey\'), from mel (\'honey\').', example:'The gingerbread recipe called for a cup of dark molasses, which gave the cookies their rich, bittersweet depth of flavor.', isNoun:true },
  { word:'monastery', pronunciation:'MON-uh-STAIR-ee', ipa:'/Ààm…ín…ôÀåst…õri/', pos:'noun', def:'A building or complex occupied by a community of monks living under religious vows.', lang:'Greek, from monastƒìrion (\'a monastery\'), from monazein (\'to live alone\'), from monos (\'alone\').', example:'The ancient monastery perched on the clifftop had been home to a community of monks for over a thousand years.', isNoun:true },
  { word:'mongoose', pronunciation:'MONG-goos', ipa:'/Ààm…í≈ã…°uÀês/', pos:'noun', def:'A small carnivorous mammal with a long body and tail, native to Africa and Asia, noted for its ability to kill venomous snakes.', lang:'Marathi, from mangus, the name for the animal in the language of western India.', example:'The quick mongoose darted at the cobra with lightning speed, dodging the snake\'s strikes before delivering a fatal bite.', isNoun:true },
  { word:'monopolize', pronunciation:'muh-NOP-uh-lyze', ipa:'/m…ôÀàn…íp…ôÀåla…™z/', pos:'verb', def:'To obtain exclusive possession or control of a commodity or service; to dominate or take over completely.', lang:'Greek, from monopolion (\'exclusive sale\'), from monos (\'alone, single\') + p≈çlein (\'to sell\'), + -ize.', example:'The talkative guest managed to monopolize the entire dinner conversation, barely letting anyone else get a word in.', isNoun:false },
  { word:'montage', pronunciation:'mon-TAHJ', ipa:'/m…ínÀàt…ëÀê í/', pos:'noun', def:'A technique of selecting, editing, and piecing together separate images or film clips to form a continuous whole; a composite picture.', lang:'French, from montage (\'an assembling\'), from monter (\'to mount, assemble\'), from Latin mons (\'mountain\').', example:'The film\'s training montage compressed weeks of preparation into two thrilling minutes set to an energetic soundtrack.', isNoun:true },
  { word:'moped', pronunciation:'MOH-ped', ipa:'/Ààmo äp…õd/', pos:'noun', def:'A light motorized bicycle with pedals and a small engine, typically with a maximum speed of around 30 mph.', lang:'Swedish, from (trampcykel med) mo(tor och) ped(aler) (\'pedal cycle with motor and pedals\'), a blend coined in 1952.', example:'She zipped through the narrow cobblestone streets on her moped, weaving past cafes and flower stalls in the morning sun.', isNoun:true },
  { word:'morose', pronunciation:'muh-ROHS', ipa:'/m…ôÀàro äs/', pos:'adjective', def:'Sullen and ill-tempered; gloomy and withdrawn.', lang:'Latin, from morosus (\'peevish, hard to please\'), from mos (genitive moris, \'habit, manner, way\').', example:'After losing the championship game, the normally cheerful coach sat morose and silent on the team bus ride home.', isNoun:false },
  { word:'muddle', pronunciation:'MUD-ul', ipa:'/Ààm åd…ôl/', pos:'verb', def:'To bring into a disordered or confusing state; to mix up; to think in a confused way.', lang:'Dutch, from moddelen (\'to dabble in mud\'), from modde (\'mud\'), or from mud + -le (frequentative suffix).', example:'She muddled through the first few weeks of the new job, gradually learning the systems until everything finally clicked.', isNoun:false },
  { word:'mummified', pronunciation:'MUM-ih-fyd', ipa:'/Ààm åm…™Àåfa…™d/', pos:'adjective', def:'Preserved as a mummy by drying or embalming; dried out and shriveled.', lang:'Persian, from mumiya (\'an embalmed body\'), from mum (\'wax\'), referring to the wax used in the embalming process, + -ify + -ed.', example:'The mummified remains discovered in the Egyptian tomb were remarkably well preserved after more than three thousand years.', isNoun:false },
  { word:'munchkin', pronunciation:'MUNCH-kin', ipa:'/Ààm ånt Ék…™n/', pos:'noun', def:'A small person, especially a child; from the tiny inhabitants of Munchkinland in The Wizard of Oz.', lang:'English, coined by L. Frank Baum in The Wonderful Wizard of Oz (1900), of uncertain origin, possibly from munch + -kin (diminutive suffix).', example:'The adorable munchkins in their Halloween costumes lined up at every door on the street, holding out their candy bags.', isNoun:true },
  { word:'musings', pronunciation:'MYOO-zingz', ipa:'/ÀàmjuÀêz…™≈ãz/', pos:'noun', def:'Thoughts or reflections, especially when aimless or abstract; periods of contemplation.', lang:'Old French, from muser (\'to ponder, waste time\'), possibly from Medieval Latin musum (\'muzzle\'), suggesting staring vacantly, + -ing + -s.', example:'Her musings on the meaning of happiness filled several leather-bound journals that lined the shelf above her writing desk.', isNoun:true },
  { word:'mythical', pronunciation:'MITH-ih-kul', ipa:'/Ààm…™Œ∏…™k…ôl/', pos:'adjective', def:'Occurring in or relating to myths or legends; imaginary or not real; idealized or exaggerated beyond reality.', lang:'Greek, from mythikos (\'of myths\'), from mythos (\'myth, story, word\'), + -al.', example:'The mythical phoenix was said to burst into flames at the end of its life and be reborn from its own ashes.', isNoun:false }
];

let currentIndex = 0, flipped = false, markedWords = new Set(), markedOnly = false;
let imageCache = {}, imageLoading = {};
let touchStartX = 0, swipeX = 0;

function aw() { return markedOnly ? WORDS.filter((_,i) => markedWords.has(i)) : WORDS; }
function si() { const a=aw(); if(markedOnly){const i=a.findIndex(w=>w.word===WORDS[currentIndex]?.word);return i>=0?i:0;} return currentIndex; }
function gi() { const a=aw(),s=si(); return WORDS.findIndex(w=>w.word===a[s]?.word); }

function speak(t) { speechSynthesis.cancel(); const u=new SpeechSynthesisUtterance(t); u.rate=0.85;u.pitch=1;u.lang="en-US"; speechSynthesis.speak(u); }

async function fetchImage(word) {
  if(imageCache[word]||imageLoading[word]) return;
  imageLoading[word]=true;
  // Update just the image placeholder if it exists
  const imgPlaceholder = document.getElementById('img-'+word);
  if(imgPlaceholder) imgPlaceholder.innerHTML=`<div class="loading-box"><div class="spinner"></div><span class="loading-text">Finding image‚Ä¶</span></div>`;
  try {
    const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1000,messages:[{role:"user",content:'Search online and find a direct image URL for "'+word+'". Return ONLY the raw URL ending in .jpg/.jpeg/.png/.svg/.webp. No markdown, no explanation.'}],tools:[{type:"web_search_20250305",name:"web_search"}]})});
    const d=await r.json(); const t=d.content.map(b=>b.type==="text"?b.text:"").filter(Boolean).join("\n").trim();
    const m=t.match(/https?:\/\/[^\s"'<>\)]+\.(jpg|jpeg|png|svg|webp)([^\s"'<>\)]*)*/i);
    imageCache[word]=m?m[0]:null;
  } catch(e){imageCache[word]=null;}
  imageLoading[word]=false;
  // Update just the image placeholder if still on same word
  const imgEl = document.getElementById('img-'+word);
  if(imgEl && imageCache[word]) {
    imgEl.innerHTML=`<div class="image-box"><img class="word-img" src="${imageCache[word]}" alt="${word}" onerror="this.parentElement.style.display='none'"><div class="img-caption">${word}</div></div>`;
  } else if(imgEl) {
    imgEl.innerHTML='';
  }
}

const starSvg=f=>`<svg viewBox="0 0 24 24" fill="${f?'currentColor':'none'}" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`;
const speakerSvg=`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>`;

function renderFront(w) {
  return `
    <div class="sect fade-in"><div class="tag">PRONUNCIATION</div><div class="pron-main">${w.pronunciation}</div><div class="ipa">${w.ipa}</div>
      <button class="listen-btn" onclick="event.stopPropagation();speak('${w.word}')">${speakerSvg}<span>Listen</span></button></div>
    <div class="sect fade-in" style="animation-delay:.06s"><div class="tag">PART OF SPEECH</div><span class="pos-chip">${w.pos}</span></div>
    <div class="sect fade-in" style="animation-delay:.12s"><div class="tag">DEFINITION</div><div class="def-text">${w.def}</div></div>
    <div class="sect fade-in" style="animation-delay:.18s"><div class="tag">LANGUAGE OF ORIGIN</div><div class="origin-text">${w.lang}</div></div>
    <div class="sect fade-in" style="animation-delay:.24s"><div class="tag">EXAMPLE</div><div class="ex-text">"${w.example.replace(new RegExp(w.word,'gi'),'________')}"</div></div>
    <div class="tap-hint fade-in" style="animation-delay:.3s">Tap card to reveal spelling</div>`;
}

function renderBack(w) {
  const letters=w.word.split("").map((c,i)=>`<span class="letter-tile" style="animation-delay:${i*0.04+0.12}s">${c}</span>`).join("");
  let img="";
  if(w.isNoun){
    let imgContent = "";
    if(imageLoading[w.word]) imgContent=`<div class="loading-box"><div class="spinner"></div><span class="loading-text">Finding image‚Ä¶</span></div>`;
    else if(imageCache[w.word]) imgContent=`<div class="image-box"><img class="word-img" src="${imageCache[w.word]}" alt="${w.word}" onerror="this.parentElement.style.display='none'"><div class="img-caption">${w.word}</div></div>`;
    img=`<div id="img-${w.word}">${imgContent}</div>`;
  }
  return `<div class="back-content">
    <div class="spelling-box" style="animation:popIn .4s cubic-bezier(.34,1.56,.64,1) both">
      <div class="spelling-label">THE WORD IS</div><h2 class="spelling-word">${w.word}</h2>
      <div class="letters-row">${letters}</div>
      <button class="listen-btn" style="margin:14px auto 0" onclick="event.stopPropagation();speak('${w.word}')">${speakerSvg}<span>Hear Again</span></button>
    </div>${img}
    <div class="tap-hint">Tap card to go back to clues</div></div>`;
}

function render() {
  const a=aw();
  if(!a.length){ document.getElementById("card").innerHTML=`<div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px"><p style="color:rgba(255,255,255,0.5);font-size:16px">No marked words yet.</p><button class="flip-btn" style="width:auto;padding:10px 24px" onclick="markedOnly=false;render()">‚Üê Show All</button></div>`; return; }
  const s=si(), g=gi(), w=a[s];

  document.getElementById("card").innerHTML=`<div class="card-top"><span class="counter">${s+1} / ${a.length}</span><div class="card-top-right"><span class="side-label">${flipped?'ANSWER':'CLUES'}</span><button class="mark-btn ${markedWords.has(g)?'active':''}" onclick="toggleMark(${g})">${starSvg(markedWords.has(g))}</button></div></div>`+(flipped?renderBack(w):renderFront(w));

  if(flipped && w.isNoun&&!imageCache[w.word]&&!imageLoading[w.word]) fetchImage(w.word);

  // Slider
  const totalA = a.length;
  const pct = totalA > 1 ? s / (totalA - 1) * 100 : 0;
  document.getElementById("sliderFill").style.width = pct + "%";
  const sliderArea = document.getElementById("sliderArea");
  const areaW = sliderArea.offsetWidth || 200;
  const pad = 10;
  const thumbLeft = pad + (pct / 100) * (areaW - pad * 2);
  const thumb = document.getElementById("sliderThumb");
  if(!thumb.classList.contains('dragging')) thumb.style.left = thumbLeft + "px";

  // Ticks - show ~20 evenly spaced markers
  const tickCount = Math.min(totalA, 20);
  let ticksHtml = '';
  for(let t=0; t<tickCount; t++){
    const ti = Math.round(t / (tickCount-1) * (totalA-1));
    const cls = ti===s ? 'active' : (t % 5 === 0 ? 'major' : '');
    ticksHtml += `<div class="slider-tick ${cls}"></div>`;
  }
  document.getElementById("sliderDots").innerHTML = ticksHtml;
  document.getElementById("sliderCounter").textContent = `${s+1} / ${totalA}`;

  // Mode btn
  const mb=document.getElementById("modeBtn");
  mb.className="mode-btn"+(markedOnly?" active":"");
  mb.querySelector("svg").setAttribute("fill",markedOnly?"currentColor":"none");
  document.getElementById("modeBtnText").textContent=(markedOnly?"Marked":"All")+` (${markedOnly?markedWords.size:WORDS.length})`;
}

function jumpTo(idx) {
  const a=aw(); if(idx<0||idx>=a.length) return;
  const g=WORDS.findIndex(w=>w.word===a[idx].word);
  flipped=false; currentIndex=g; render();
  setTimeout(()=>speak(a[idx].word),200);
}

function navigateTo(dir) {
  const a=aw(); if(!a.length) return;
  const s=si(), card=document.getElementById("card");
  card.classList.add(dir==="left"?"slide-out-l":"slide-out-r");
  flipped=false;
  setTimeout(()=>{
    card.classList.remove("slide-out-l","slide-out-r");
    const ni=dir==="left"?(s+1)%a.length:(s-1+a.length)%a.length;
    currentIndex=WORDS.findIndex(w=>w.word===a[ni].word);
    render(); setTimeout(()=>speak(a[ni].word),150);
  },220);
}

function flipCard(){flipped=!flipped;render();}
function toggleMark(g){markedWords.has(g)?markedWords.delete(g):markedWords.add(g);render();}
function toggleMarkedOnly(){if(!markedOnly&&markedWords.size===0)return;markedOnly=!markedOnly;flipped=false;render();}

// Swipe
const ca=document.getElementById("cardArea");
let swiped=false;
ca.addEventListener("touchstart",e=>{touchStartX=e.touches[0].clientX;swiped=false;},{passive:true});
ca.addEventListener("touchmove",e=>{swipeX=e.touches[0].clientX-touchStartX;if(Math.abs(swipeX)>15)swiped=true;},{passive:true});
ca.addEventListener("touchend",()=>{if(Math.abs(swipeX)>50)navigateTo(swipeX<0?"left":"right");swipeX=0;});

// Card tap to flip
const card=document.getElementById("card");
card.addEventListener("click",e=>{
  if(e.target.closest('button')||swiped) return;
  flipCard();
});

// Slider drag
const slArea=document.getElementById("sliderArea");
const slThumb=document.getElementById("sliderThumb");
let slDragging=false;
function sliderFromX(cx){
  const r=slArea.getBoundingClientRect();
  const pad=10;
  const p=Math.max(0,Math.min(1,(cx-r.left-pad)/(r.width-pad*2)));
  const a=aw(),idx=Math.round(p*(a.length-1));
  // Move thumb immediately for smooth feel
  const thumbLeft=pad+(p)*(r.width-pad*2);
  slThumb.style.left=thumbLeft+"px";
  if(idx!==si()){
    const g=WORDS.findIndex(w=>w.word===a[idx].word);
    flipped=false; currentIndex=g; render();
  }
}
slArea.addEventListener("touchstart",e=>{
  slDragging=true; slThumb.classList.add('dragging');
  sliderFromX(e.touches[0].clientX);
},{passive:true});
document.addEventListener("touchmove",e=>{
  if(slDragging) sliderFromX(e.touches[0].clientX);
},{passive:true});
document.addEventListener("touchend",()=>{
  if(slDragging){
    slDragging=false; slThumb.classList.remove('dragging');
    // Speak the word after releasing
    const a=aw(),s=si();
    if(a[s]) setTimeout(()=>speak(a[s].word),100);
  }
});
slArea.addEventListener("mousedown",e=>{
  slDragging=true; slThumb.classList.add('dragging');
  sliderFromX(e.clientX); e.preventDefault();
});
document.addEventListener("mousemove",e=>{
  if(slDragging) sliderFromX(e.clientX);
});
document.addEventListener("mouseup",()=>{
  if(slDragging){
    slDragging=false; slThumb.classList.remove('dragging');
    const a=aw(),s=si();
    if(a[s]) setTimeout(()=>speak(a[s].word),100);
  }
});

// Keyboard
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowRight")navigateTo("left");
  else if(e.key==="ArrowLeft")navigateTo("right");
  else if(e.key===" "){e.preventDefault();flipCard();}
});

render();
setTimeout(()=>speak(WORDS[0].word),500);
</script>
</body>
</html>
